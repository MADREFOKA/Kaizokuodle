<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Piece Games</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Outfit:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Outfit', sans-serif;
            background: linear-gradient(135deg, #0a1929 0%, #1e3a5f 50%, #0a1929 100%);
            min-height: 100vh;
            color: #fff;
        }
        .title-font { font-family: 'Bangers', cursive; letter-spacing: 2px; }
        .game-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .game-card:hover {
            transform: translateY(-10px);
            border-color: rgba(255, 215, 0, 0.5);
            box-shadow: 0 20px 60px rgba(255, 215, 0, 0.2);
        }
        .wordle-cell {
            width: 70px; height: 70px;
            border: 2px solid rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            font-size: 0.75rem; font-weight: 600;
            text-align: center; padding: 0.25rem;
            background: rgba(255, 255, 255, 0.9);
            color: #1a1a2e;
        }
        .wordle-cell.correct { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .wordle-cell.partial { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .wordle-cell.incorrect { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
        .grid-cell {
            aspect-ratio: 1; background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(0, 0, 0, 0.2); border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.3s ease;
            font-size: 0.9rem; text-align: center; padding: 0.5rem;
            color: #1a1a2e; font-weight: 600;
        }
        .grid-cell.filled { background: linear-gradient(135deg, #10b981, #059669); border-color: #10b981; color: white; }
        .timeline-item {
            background: rgba(255, 255, 255, 0.9); border: 2px solid rgba(0, 0, 0, 0.2);
            border-radius: 12px; padding: 1rem; cursor: move;
            transition: all 0.3s ease; user-select: none; color: #1a1a2e;
        }
        .timeline-item.correct { background: linear-gradient(135deg, #10b981, #059669); color: white; }
        .timeline-item.incorrect { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [currentGame, setCurrentGame] = useState('menu');
            const [characters, setCharacters] = useState([]);
            const [fruits, setFruits] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                // RUTAS CORRECTAS PARA GITHUB PAGES
                const basePath = window.location.pathname.includes('github.io') 
                    ? window.location.pathname.split('/').slice(0, 2).join('/') + '/'
                    : './';
                
                Promise.all([
                    fetch(basePath + 'characters.json').then(r => r.json()),
                    fetch(basePath + 'fruits.json').then(r => r.json())
                ]).then(([chars, fr]) => {
                    setCharacters(chars);
                    setFruits(fr);
                    setLoading(false);
                }).catch(err => {
                    console.error('Error cargando datos:', err);
                    setLoading(false);
                });
            }, []);

            if (loading) {
                return <div className="min-h-screen flex items-center justify-center"><div className="text-6xl animate-pulse">üè¥‚Äç‚ò†Ô∏è</div><p className="text-2xl mt-4">Cargando datos...</p></div>;
            }

            const games = {
                menu: <GameMenu setCurrentGame={setCurrentGame} />,
                wordle: <WordleGame characters={characters} setCurrentGame={setCurrentGame} />,
                grid: <GridGame characters={characters} setCurrentGame={setCurrentGame} />,
                higher: <HigherLowerGame characters={characters} setCurrentGame={setCurrentGame} />,
                timeline: <TimelineGame characters={characters} setCurrentGame={setCurrentGame} />,
                fruit: <FruitGuesser fruits={fruits} setCurrentGame={setCurrentGame} />,
                fill: <FillBlanksGame characters={characters} setCurrentGame={setCurrentGame} />
            };

            return games[currentGame] || <GameMenu setCurrentGame={setCurrentGame} />;
        }

        function GameMenu({ setCurrentGame }) {
            const games = [
                { id: 'wordle', name: 'Adivina el Personaje', icon: 'üîç', desc: 'Wordle con 5 dificultades' },
                { id: 'grid', name: 'Grid Challenge', icon: 'üéØ', desc: 'Matriz 3x3' },
                { id: 'higher', name: 'Higher or Lower', icon: 'üìà', desc: 'Compara recompensas' },
                { id: 'timeline', name: 'Timeline', icon: '‚è∞', desc: 'Ordena por aparici√≥n' },
                { id: 'fruit', name: 'Adivina Fruta/Usuario', icon: 'üçé', desc: 'Frutas del diablo' },
                { id: 'fill', name: 'Rellena los Datos', icon: '‚úèÔ∏è', desc: 'Completa informaci√≥n' }
            ];

            return (
                <div className="min-h-screen p-8">
                    <div className="max-w-7xl mx-auto">
                        <div className="text-center mb-12">
                            <h1 className="title-font text-7xl mb-4 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-600 bg-clip-text text-transparent">
                                ONE PIECE GAMES
                            </h1>
                            <p className="text-xl">üè¥‚Äç‚ò†Ô∏è Colecci√≥n de juegos para nakamas üè¥‚Äç‚ò†Ô∏è</p>
                        </div>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {games.map(g => (
                                <div key={g.id} className="game-card" onClick={() => setCurrentGame(g.id)}>
                                    <div className="text-6xl mb-4">{g.icon}</div>
                                    <h3 className="text-2xl font-bold mb-2">{g.name}</h3>
                                    <p className="text-gray-400">{g.desc}</p>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // WORDLE COMPLETO
        function WordleGame({ characters, setCurrentGame }) {
            const [difficulty, setDifficulty] = useState(1);
            const [target, setTarget] = useState(null);
            const [guesses, setGuesses] = useState([]);
            const [input, setInput] = useState('');
            const [suggestions, setSuggestions] = useState([]);
            const [gameOver, setGameOver] = useState(false);
            const [won, setWon] = useState(false);
            const [gameStarted, setGameStarted] = useState(false);

            const difficulties = [
                { id: 1, name: 'Grumete', levels: [1] },
                { id: 2, name: 'Novato', levels: [1, 2] },
                { id: 3, name: 'Supernova', levels: [1, 2, 3] },
                { id: 4, name: 'Shichibukai', levels: [1, 2, 3, 4] },
                { id: 5, name: 'Yonkou', levels: [1, 2, 3, 4, 5] }
            ];

            const fields = ['Nombre', 'Primera Aparici√≥n', 'Saga', 'Arco', 'Origen', 'Raza', 'Sexo', 'Estado', 'Altura', 'Edad', 'Cumplea√±os', 'Fruta del diablo', 'Haki', 'Recompensa', 'Afiliaci√≥n', 'Ocupaci√≥n'];

            const startGame = () => {
                const diff = difficulties.find(d => d.id === difficulty);
                const valid = characters.filter(c => c.Nombre && diff.levels.includes(parseInt(c.Dificultad)));
                setTarget(valid[Math.floor(Math.random() * valid.length)]);
                setGameStarted(true);
                setGuesses([]);
                setGameOver(false);
                setWon(false);
            };

            const compareValues = (guess, target, field) => {
                const g = guess[field]?.toString().toLowerCase().trim() || '';
                const t = target[field]?.toString().toLowerCase().trim() || '';
                
                if (g === t) return { status: 'correct', arrow: null };
                
                if (['Primera Aparici√≥n', 'Altura', 'Edad', 'Recompensa'].includes(field)) {
                    const gNum = parseFloat(g.replace(/[^\d.]/g, ''));
                    const tNum = parseFloat(t.replace(/[^\d.]/g, ''));
                    if (!isNaN(gNum) && !isNaN(tNum)) {
                        return { status: 'incorrect', arrow: gNum < tNum ? '‚Üë' : '‚Üì' };
                    }
                }

                if (['Raza', 'Fruta del diablo', 'Haki', 'Ocupaci√≥n'].includes(field)) {
                    if (g.includes(t) || t.includes(g)) return { status: 'partial', arrow: null };
                }
                
                return { status: 'incorrect', arrow: null };
            };

            const handleGuess = (char) => {
                const newGuesses = [...guesses, char];
                setGuesses(newGuesses);
                setInput('');
                setSuggestions([]);

                if (char.Nombre === target.Nombre) {
                    setWon(true);
                    setGameOver(true);
                } else if (newGuesses.length >= 6) {
                    setGameOver(true);
                }
            };

            if (!gameStarted) {
                return (
                    <div className="min-h-screen p-8">
                        <div className="max-w-4xl mx-auto">
                            <button onClick={() => setCurrentGame('menu')} className="mb-8 px-4 py-2 bg-white/10 rounded-lg">‚Üê Volver</button>
                            <h1 className="title-font text-6xl mb-8 text-center bg-gradient-to-r from-purple-400 to-blue-600 bg-clip-text text-transparent">ADIVINA EL PERSONAJE</h1>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                                {difficulties.map(d => (
                                    <button key={d.id} onClick={() => setDifficulty(d.id)} className={`p-4 rounded-lg font-bold ${difficulty === d.id ? 'bg-orange-500' : 'bg-white/10'}`}>
                                        <div className="text-xl">{d.name}</div>
                                    </button>
                                ))}
                            </div>
                            <div className="text-center">
                                <button onClick={startGame} className="px-8 py-4 bg-orange-500 rounded-lg text-xl font-bold">Comenzar</button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen p-8">
                    <div className="max-w-full mx-auto px-4">
                        <div className="flex justify-between mb-6">
                            <button onClick={() => setGameStarted(false)} className="px-4 py-2 bg-white/10 rounded-lg">‚Üê Cambiar</button>
                            <h1 className="title-font text-4xl bg-gradient-to-r from-purple-400 to-blue-600 bg-clip-text text-transparent">ADIVINA EL PERSONAJE</h1>
                            <div className="flex gap-2">
                                <button onClick={() => { setGameStarted(false); setGuesses([]); }} className="px-4 py-2 bg-white/10 rounded-lg">üîÑ</button>
                                <button onClick={() => { setGameOver(true); setWon(false); }} className="px-4 py-2 bg-red-500 rounded-lg" disabled={gameOver}>üè≥Ô∏è</button>
                            </div>
                        </div>

                        <div className="mb-6 p-4 bg-white/90 rounded-xl text-black text-sm">
                            <strong>Leyenda:</strong>
                            <span className="mx-2 px-2 py-1 bg-green-500 text-white rounded">Verde</span>
                            <span className="mx-2 px-2 py-1 bg-yellow-500 text-white rounded">Amarillo</span>
                            <span className="mx-2 px-2 py-1 bg-red-500 text-white rounded">Rojo</span>
                        </div>

                        {!gameOver && (
                            <div className="mb-6 relative">
                                <input
                                    type="text"
                                    value={input}
                                    onChange={(e) => {
                                        setInput(e.target.value);
                                        if (e.target.value.length > 0) {
                                            setSuggestions(characters.filter(c => c.Nombre?.toLowerCase().includes(e.target.value.toLowerCase())).slice(0, 10));
                                        } else {
                                            setSuggestions([]);
                                        }
                                    }}
                                    placeholder="Escribe el nombre del personaje..."
                                    className="w-full p-4 rounded-lg bg-white text-black"
                                />
                                {suggestions.length > 0 && (
                                    <div className="absolute w-full mt-2 bg-white rounded-lg shadow-lg max-h-60 overflow-y-auto z-10">
                                        {suggestions.map((c, i) => (
                                            <div key={i} onClick={() => handleGuess(c)} className="p-3 hover:bg-gray-100 cursor-pointer text-black">
                                                {c.Nombre}
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}

                        <div className="overflow-x-auto">
                            <div className="flex gap-2 mb-4" style={{minWidth: '1200px'}}>
                                {fields.map(f => <div key={f} className="wordle-cell font-bold text-xs">{f.split(' ')[0]}</div>)}
                            </div>
                            {guesses.map((g, i) => (
                                <div key={i} className="flex gap-2 mb-2" style={{minWidth: '1200px'}}>
                                    {fields.map(f => {
                                        const comp = f === 'Nombre' ? { status: g.Nombre === target.Nombre ? 'correct' : 'incorrect', arrow: null } : compareValues(g, target, f);
                                        return (
                                            <div key={f} className={`wordle-cell ${comp.status}`}>
                                                <span className="truncate text-xs">{g[f] || '---'}</span>
                                                {comp.arrow && <div className="text-lg">{comp.arrow}</div>}
                                            </div>
                                        );
                                    })}
                                </div>
                            ))}
                        </div>

                        {gameOver && (
                            <div className="mt-8 text-center p-8 bg-white/90 rounded-2xl text-black">
                                <h2 className="text-4xl font-bold mb-4">{won ? 'üéâ ¬°GANASTE! üéâ' : 'üò¢ PERDISTE üò¢'}</h2>
                                <p className="text-2xl mb-6">El personaje era: <span className="font-bold text-orange-600">{target.Nombre}</span></p>
                                <button onClick={startGame} className="px-8 py-4 bg-orange-500 text-white rounded-lg text-xl font-bold">Jugar de nuevo</button>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Otros juegos placeholder
        function GridGame() { return <div className="min-h-screen p-8"><button onClick={() => window.location.reload()} className="mb-4 px-4 py-2 bg-white/10 rounded-lg">‚Üê Volver</button><h1 className="text-4xl text-center">Grid Challenge - Pr√≥ximamente</h1></div>; }
        function HigherLowerGame() { return <div className="min-h-screen p-8"><button onClick={() => window.location.reload()} className="mb-4 px-4 py-2 bg-white/10 rounded-lg">‚Üê Volver</button><h1 className="text-4xl text-center">Higher or Lower - Pr√≥ximamente</h1></div>; }
        function TimelineGame() { return <div className="min-h-screen p-8"><button onClick={() => window.location.reload()} className="mb-4 px-4 py-2 bg-white/10 rounded-lg">‚Üê Volver</button><h1 className="text-4xl text-center">Timeline - Pr√≥ximamente</h1></div>; }
        function FruitGuesser() { return <div className="min-h-screen p-8"><button onClick={() => window.location.reload()} className="mb-4 px-4 py-2 bg-white/10 rounded-lg">‚Üê Volver</button><h1 className="text-4xl text-center">Frutas - Pr√≥ximamente</h1></div>; }
        function FillBlanksGame() { return <div className="min-h-screen p-8"><button onClick={() => window.location.reload()} className="mb-4 px-4 py-2 bg-white/10 rounded-lg">‚Üê Volver</button><h1 className="text-4xl text-center">Fill - Pr√≥ximamente</h1></div>; }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
